name: "Mazdaspeed 6/Mazda 6 MPS/Mazdaspeed Atenza"
id: "mazdaspeed6"

romsize: 1048576

baudrate: 500000

logmode: "uds"

vins:
  - "JM1GG12L........."

transfer:
  flashmode: "MazdaT1"
  downloadmode: "Mazda23"
  serverid: 0x7E0
  
auth:
  key: "MazdA"
  download_sessionid: 0x87
  flash_sessionid: 0x85


# Tables
tables:
  0:
    name: Overload Protection Fuel Cut
    description: Overload Protection Fuel Cut
    category: Limits
    datatype: float
    width: 14
    height: 8
    minimum: 0
    maximum: 4

  1:
    name: Intake Cam Advance (VVT)
    description: Intake Cam Advance (VVT)
    category: Valve Timing
    datatype: float
    width: 14
    height: 32
    axisx: rpm_500_linear
    axisy: load_0625
    minimum: 0
    maximum: 60

  2:
    name: Closed Loop AFR Target
    description: Closed Loop AFR Target
    category: Fuel Injection
    datatype: float
    width: 10
    height: 31
    axisx: rpm_500_linear
    axisy: load_125
    minimum: 0.5
    maximum: 1.5

  4:
    name: Idle RPM (In Gear, No A/C)
    description: Idle RPM (In Gear, No A/C)
    category: Idle
    datatype: float
    width: 8
    axisx: temp_coolant
    minimum: 500
    maximum: 2500

  6:
    name: Fan On Voltage Adjustment
    description: Fan On Voltage Adjustment
    category: Fan Control
    datatype: float
    width: 7
    axisx: voltage_batt
    minimum: 0
    maximum: 2

  8:
    name: Idle RPM (Not in gear, A/C on)
    description: Idle RPM (Not in gear, A/C on)
    category: Idle
    datatype: float
    width: 8
    axisx: pressure_kpa
    minimum: 500
    maximum: 2500

  9:
    name: Open Loop Timing (Normal)
    description: Open Loop Timing (Normal)
    category: Ignition
    datatype: float
    width: 14
    height: 28
    axisx: rpm_500_linear
    axisy: load_3125
    minimum: -25
    maximum: 75

  10:
    name: Speed Limit Threshold (Throttle Close)
    description: Speed Limit Threshold (Throttle Close)
    category: Limits
    datatype: float
    minimum: 3
    maximum: 10

  11:
    name: Closed Loop Timing (Overload)
    description: Closed Loop Timing (Overload)
    category: Ignition
    datatype: float
    width: 14
    height: 28
    axisx: rpm_500_linear
    axisy: load_3125
    minimum: -15
    maximum: 70

  12:
    name: Speed Limit (Throttle Close)
    description: Speed Limit (Throttle Close)
    category: Limits
    datatype: float
    minimum: 0
    maximum: 350

  13:
    name: Overboost Fuel Cut
    description: Overboost Fuel Cut
    category: Limits
    datatype: float
    width: 14
    height: 8
    axisx: rpm_500
    axisy: pressure_kpa
    minimum: 0
    maximum: 450

  14:
    name: Speed Limit (Fuel cut)
    description: Speed Limit (Fuel cut)
    datatype: float
    category: Limits
    width: 1

  15:
    name: MAF Calibration 2
    description: MAF Calibration 2
    category: MAF
    datatype: float
    width: 129
    axisx: maf_5
    minimum: 0
    maximum: 850

  16:
    name: RPM Limit
    description: RPM Limit
    category: Limits
    datatype: float
    minimum: 0
    maximum: 8500

  17:
    name: Closed Loop Timing (Normal)
    description: Closed Loop Timing (Normal)
    category: Ignition
    datatype: float
    width: 14
    height: 28
    axisx: rpm_500_linear
    axisy: load_3125
    minimum: -15
    maximum: 70

  18:
    name: Open Loop Timing (Overload)
    description: Open Loop Timing (Overload)
    category: Ignition
    datatype: float
    width: 14
    height: 28
    axisx: rpm_500_linear
    axisy: load_3125
    minimum: -15
    maximum: 70

  19:
    name: Speed Limit Threshold (Fuel Cut)
    description: Speed Limit Threshold (Fuel Cut)
    category: Limits
    datatype: float
    minimum: 3
    maximum: 15

  20:
    name: Idle RPM (In Gear, A/C)
    description: Idle RPM (In Gear, A/C)
    category: Idle
    datatype: float
    width: 8
    axisx: pressure_kpa
    minimum: 500
    maximum: 2500

  21:
    name: Overboost Throttle Cut
    description: Overboost Throttle Cut
    category: Limits
    datatype: float
    width: 14
    axisx: rpm_500
    minimum: 0
    maximum: 450

  22:
    name: Fan On Engine Coolant Temperature
    description: Fan On Engine Coolant Temperature
    category: Fan Control
    datatype: float
    width: 8
    axisx: pressure_kpa
    minimum: 0
    maximum: 180

  23:
    name: MAF Calibration 1
    description: MAF Calibration 1
    category: MAF
    datatype: float
    width: 129
    axisx: maf_5
    minimum: 0
    maximum: 850

  24:
    name: Idle RPM - Neutral
    description: Idle RPM - Neutral
    category: Idle
    datatype: float
    width: 8
    axisx: temp_coolant
    minimum: 500
    maximum: 2500

  25:
    name: Maximum Load Limit
    description: Maximum Load Limit
    category: Limits
    datatype: float
    width: 14
    axisx: rpm_500_linear
    minimum: 0
    maximum: 4



# Axes
axes:
  #- id: "rpm_500"
  #  type: "linear"
  #  datatype: "uint32"
  #  name: "RPM"
  #  minimum: 500
  #  increment: 500

  - id: "rpm_500"
    size: 14
    type: "memory"
    datatype: "float"
    name: "RPM"
    
  - id: "rpm_500_15"
    size: 15
    type: "memory"
    datatype: "float"
    name: "RPM"
    
  - id: "rpm_500_linear"
    type: "linear"
    datatype: "float"
    name: "RPM"
    minimum: 500
    increment: 500
    
  - id: "load_125"
    type: "linear"
    datatype: "float"
    name: "Load"
    minimum: 0.125
    increment: 0.0625
    
  - id: "load_025"
    type: "linear"
    datatype: "float"
    name: "Load"
    minimum: 0.25
    increment: 0.0625
    
  - id: "load_0625"
    type: "linear"
    datatype: "float"
    name: "Load"
    minimum: 0.0625
    increment: 0.0625
    
  - id: "load_3125"
    type: "linear"
    datatype: "float"
    name: "Load"
    minimum: 0.3125
    increment: 0.0625
    
  - id: "pressure_kpa"
    size: 8
    type: "memory"
    datatype: "float"
    name: "Barometric Pressure"
    
  - id: "pressure_kpa_diff"
    size: 11
    type: "memory"
    datatype: "float"
    name: "Boost Target Difference"
    
  - id: "bsc_dc_volts"
    type: "linear"
    datatype: "float"
    name: "Battery Voltage"
    minimum: 6.5
    increment: 1.25
    
  - id: "temp_iat"
    type: "linear"
    datatype: "float"
    name: "Intake Air Temperature (Celsius)"
    minimum: -40
    increment: 20

  - id: "temp_coolant"
    type: "linear"
    datatype: "float"
    name: "Coolant Temperature (Celsius)"
    minimum: -40
    increment: 20
    
  - id: "tps_0"
    type: "linear"
    datatype: "float"
    minimum: 0
    increment: 6.25
    name: "Requested Throttle Position"
    
  - id: "maf_5"
    type: "linear"
    datatype: "float"
    minimum: 0
    increment: 0.039000001
    name: "Voltage"
    
  - id: "voltage_batt"
    type: "memory"
    datatype: "float"
    name: "Battery Voltage"
    size: 7

flashregion:
  offset: 0x8000
  size: 0xF8000

# PIDs
pids:
  - id: 0
    name: "Coolant Temperature"
    description: "Coolant Temperature"
    code: 0x0005
    unit: "temp_celsius"
    formula: "a - 40"
    
  - id: 1
    name: "Engine RPM"
    description: "Engine RPM"
    code: 0x000C
    unit: "rpm"
    formula: "(256 * a + b) / 4"

  - id: 2
    name: "Vehicle speed"
    description: "Speed of the vehicle in km/h"
    code: 0x000D
    unit: "km/h"
    formula: "a"

  - id: 3
    name: "Absolute load"
    description: "The absolute load of the engine; how hard the engine is working"
    code: 0x0043
    unit: "none"
    formula: "(a * 256 + b) / 255"

  - id: 4
    name: "Accelerator pedal position"
    description: "How far the pedal position is depressed"
    code: 0x1340
    unit: "percentage"
    formula: "a * 1024 / 2601"

  - id: 5
    name: "Air-fuel equivalence ratio"
    description: "The ratio of actual AFR to stoichiometry for a given mixture. lambda = 1.0 is at stoichiometry, rich mixtures labmda < 1.0, and lean mixtures lambda > 1.0."
    code: 0x174f
    unit: "ratio"
    formula: "a / 128"

  - id: 6
    name: "Valve timing"
    description: "Timing advance in degrees of the camshafts"
    code: 0x16cd
    unit: "degrees"
    formula: "(a * 256 + b) / 16"

  - id: 7
    name: "Ambient air temperature"
    description: "Ambient air temperature"
    code: 0x0046
    unit: "temp_celsius"
    formula: "a - 40"

  - id: 8
    name: "Absolute Barometric pressure"
    description: "External atmospheric pressure"
    code: 0x0033
    unit: "pressure_kPa"
    formula: "a"

  - id: 9
    name: "Control module voltage"
    description: "Voltage supplied to ECU"
    code: 0x0042
    unit: "voltage"
    formula: "(256 * a + b) / 1000"

  - id: 10
    name: "Boost air temperature"
    description: "The temperature in the intake manifold"
    code: 0x1723
    unit: "temp_celsius"
    formula: "(a * 0.625) - 40"

  - id: 11
    name: "Fuel–Air commanded equivalence ratio"
    description: "The target fuel-air equivalence ratio"
    code: 0x0044
    unit: "ratio"
    formula: "2 * (256 * a + b) / 65536"

  - id: 12
    name: "Target engine RPM"
    description: "The engine RPM the ECU is targetting"
    code: 0x096e
    unit: "rpm"
    formula: "(a * 256 + b) / 4"

  - id: 13
    name: "Commanded throttle actuator"
    description: "The throttle position that the ECU is targetting"
    code: 0x004c
    unit: "percentage"
    formula: "a * 100 / 255"

  - id: 14
    name: "Fuel injection pulse width"
    description: "The time each injector is held open it its injection cycle"
    code: 0x1410
    unit: "time"
    formula: "(a * 256 + b) * 0.008"

  - id: 15
    name: "Fuel Rail Gauge Pressure"
    description: "The high pressure fuel rail's pressure"
    code: 0x0023
    unit: "pressure_kPa"
    formula: "10 * (256 * a + b)"

  - id: 16
    name: "Intake air temperature"
    description: "The temperature of air measured by the MAF sensor"
    code: 0x000f
    unit: "temp_celsius"
    formula: "a - 40"

  - id: 17
    name: "Knock retard"
    description: "The degrees that the spark timing is retarded as response to the knock sensor"
    code: 0x1746
    unit: "degrees"
    formula: "a * 0.3515625"

  - id: 18
    name: "Long term fuel trim"
    description: "The percentage difference from the base amount calculated from long term oxygen sensor measurements. Negative means fuel is reduced (too rich). Positive means fuel is added (too lean)."
    code: 0x0007
    unit: "percentage"
    formula: "a / 1.28 - 100"

  - id: 19
    name: "Short term fuel trim (primary)"
    description: "The short term fuel trim calculated from the primary oxygen sensor"
    code: 0x0006
    unit: "percentage"
    formula: "a / 1.28 - 100"

  - id: 19
    name: "Short term fuel trim (secondary)"
    description: "The short term fuel trim calculated from the secondary oxygen sensor"
    code: 0x163e
    unit: "percentage"
    formula: "(a * 256 + b) * 0.00012207031"

  - id: 21
    name: "Intake manifold absolute pressure"
    description: "The pressure of the intake manifold"
    code: 0x000b
    unit: "pressure_kPa"
    formula: "a"

  - id: 22
    name: "Mass air flow rate"
    description: "The flow rate of air measured by the MAF sensor"
    code: 0x0010
    unit: "grams/sec"
    formula: "(256 * a + b) / 100"

  - id: 23
    name: "MAF sensor voltage"
    description: "The voltage output by the MAF sensor"
    code: 0x1177
    unit: "voltage"
    formula: "(a * 256 + b) / 4096"

  - id: 24
    name: "Relative throttle position"
    description: "The throttle position relative to the learned closed position"
    code: 0x0045
    unit: "percentage"
    formula: "100 * a / 255"

  - id: 25
    name: "Timing advance"
    description: "The spark timing advance relative to TDC"
    code: 0x000e
    unit: "degrees"
    formula: "a / 2 - 64"

  - id: 26
    name: "Wastegate control solenoid duty cycle"
    description: "The duty cycle of the boost control solenoid."
    code: 0x16e1
    unit: "percentage"
    formula: "(a * 256 + b) * 100 / 65536"

  - id: 27
    name: "Fuel injection amount"
    description: "The amount of fuel injected in each cylinder per cycle"
    code: 0x1752
    unit: "fuel_injection"
    formula: "(a * 256 + b) / 32.728"

  - id: 28
    name: "Air to fuel ratio"
    description: "The air to fuel ratio measured by the wideband oxygen sensor"
    code: 0x174f
    unit: "ratio"
    formula: "a / 128 * 14.7"

  - id: 29
    name: "Fuel–Air commanded ratio"
    description: "The air to fuel ratio targeted by the ECU"
    code: 0x0044
    unit: "none"
    formula: "2 * (256 * a + b) / 65536 * 14.7"

  - id: 30
    name: "Clutch pedal position"
    description: "Clutch pedal position. 0 is released, 1 is depressed."
    code: 0xA211
    unit: "none"
    formula: "b % 1"
  
  - id: 31
    name: "Neutral gear position"
    description: "0 - gearbox is in drive, 1 - gearbox is in neutral"
    code: 0xA211
    unit: "none"
    formula: "(a / 4) % 2"

  - id: 32
    name: "MAP sensor voltage"
    description: "Voltage output by the MAP sensor"
    code: 0x0900
    unit: "voltage"
    formula: "(a * 256 + b) / 1024"

  - id: 33
    name: "Fuel pressure sensor voltage"
    description: "Voltage output by the fuel sensor"
    code: 0x168b
    unit: "voltage"
    formula: "(a * 256 + b) * 5 / 65535"

  - id: 34
    name: "Target fuel rail pressure"
    description: "The fuel rail pressure the ECU is targetting"
    code: 0x1747
    unit: "pressure_kPa"
    formula: "(a * 256 + b) * 10"

  - id: 35
    name: "Oxygen sensor voltage"
    description: "Voltage of the narrow band oxygen sensor"
    code: 0x0015
    unit: "voltage"
    formula: "a / 200"
